# 画面設計書

## プロジェクト名
**ぱっと記録（Patto Kiroku）**

---

## 1. 画面一覧

| No | 画面ID | 画面名 | パス | 認証 | ロール制限 |
|---|---|---|---|---|---|
| 1 | SCR-LOGIN | ログイン / 新規登録 | `/login` | 不要 | - |
| 2 | SCR-JOIN | スタッフ参加 | `/join?facility={id}` | 不要 | - |
| 3 | SCR-HOME | 本日の記録（ホーム） | `/` | 必要 | - |
| 4 | SCR-RECORD | 日次記録入力 | `/record/[childId]` | 必要 | - |
| 5 | SCR-CHILDREN | 児童一覧 | `/children` | 必要 | - |
| 6 | SCR-CHILD-NEW | 児童新規登録 | `/children/new` | 必要 | - |
| 7 | SCR-CHILD-EDIT | 児童情報編集 | `/children/[childId]` | 必要 | - |
| 8 | SCR-DOC-MENU | 帳票メニュー | `/documents` | 必要 | - |
| 9 | SCR-DAILY-LOG | 業務日誌 | `/documents/daily-log` | 必要 | - |
| 10 | SCR-SVC-REC | サービス提供記録 | `/documents/service-record` | 必要 | - |
| 11 | SCR-MONTHLY | 月間出席サマリー | `/documents/monthly-summary` | 必要 | - |
| 12 | SCR-HISTORY | 記録履歴 | `/history` | 必要 | - |
| 13 | SCR-SETTINGS | 設定メニュー | `/settings` | 必要 | - |
| 14 | SCR-PROFILE | プロフィール編集 | `/settings/profile` | 必要 | - |
| 15 | SCR-FACILITY | 施設設定 | `/settings/facility` | 必要 | admin |
| 16 | SCR-PHRASES | フレーズ管理 | `/settings/phrases` | 必要 | - |
| 17 | SCR-PHRASE-NEW | フレーズ新規追加 | `/settings/phrases/new` | 必要 | - |
| 18 | SCR-PHRASE-EDIT | フレーズ編集 | `/settings/phrases/[phraseId]` | 必要 | - |
| 19 | SCR-STAFF | スタッフ管理 | `/settings/staff` | 必要 | admin |
| 20 | SCR-INVITE | 招待リンク | `/settings/staff/invite` | 必要 | admin |

---

## 2. 画面遷移図

```
[ログイン/新規登録] ──認証成功──> [ホーム]
[スタッフ参加] ──認証成功──> [ホーム]

[ホーム]
  ├── 児童タップ ──> [日次記録入力]
  ├── BottomNav「児童」──> [児童一覧]
  ├── BottomNav「帳票」──> [帳票メニュー]
  ├── BottomNav「履歴」──> [記録履歴]
  └── BottomNav「設定」──> [設定メニュー]

[日次記録入力] ──保存──> [次の未記録児童] or [ホーム]

[児童一覧]
  ├── 「+追加」──> [児童新規登録]
  └── 児童タップ ──> [児童情報編集]

[帳票メニュー]
  ├── 業務日誌 ──> [業務日誌]
  ├── サービス提供記録 ──> [サービス提供記録]
  └── 月間出席サマリー ──> [月間出席サマリー]

[設定メニュー]
  ├── プロフィール ──> [プロフィール編集]
  ├── フレーズ管理 ──> [フレーズ管理]
  │     ├── 「+追加」──> [フレーズ新規追加]
  │     └── フレーズタップ ──> [フレーズ編集]
  ├── 施設設定（admin） ──> [施設設定]
  └── スタッフ管理（admin） ──> [スタッフ管理]
        └── 「招待」──> [招待リンク]
```

---

## 3. 共通レイアウト

### 3.1 ルートレイアウト（全画面共通）
- フォント: Noto Sans JP（400, 500, 700）
- テーマカラー: `#1B6B4A`
- ビューポート: `width=device-width, initial-scale=1`

### 3.2 メインレイアウト（認証後画面共通）
- 下部にボトムナビゲーション（固定配置）
- セーフエリア対応（PWAノッチ対応）
- ナビゲーション項目:
  - きょう（ホームアイコン）→ `/`
  - 児童（人物アイコン）→ `/children`
  - 帳票（ドキュメントアイコン）→ `/documents`
  - 履歴（時計アイコン）→ `/history`
  - 設定（歯車アイコン）→ `/settings`

---

## 4. デザイントークン

### 4.1 カラーパレット
| トークン名 | 値 | 用途 |
|---|---|---|
| `--primary` | `#1B6B4A` | メインブランドカラー、ボタン、アクティブ状態 |
| `--primary-light` | `#E8F5EE` | 選択状態の背景 |
| `--accent` | `#E8913A` | アクセント、警告（未記録バッジ） |
| `--accent-light` | `#FFF3E6` | アクセント背景 |
| `--foreground` | `#1A1A1A` | メインテキスト |
| `--sub` | `#6B7280` | サブテキスト |
| `--border` | `#E5E7EB` | ボーダー |
| `--danger` | `#DC2626` | 危険アクション |
| `--danger-light` | `#FEF2F2` | 危険アクション背景 |
| `--background` | `#FAFAF7` | ページ背景 |

### 4.2 タイポグラフィ
| 要素 | サイズ | ウェイト |
|---|---|---|
| ヘッダータイトル | 18px | bold (700) |
| セクションタイトル | 16px | bold (700) |
| 本文 | 15px | normal (400) |
| ラベル | 14px | medium (500) |
| サブテキスト | 13px | normal (400)/medium (500) |
| バッジテキスト | 12px | medium (500) |

### 4.3 スペーシング・形状
| 要素 | 値 |
|---|---|
| カード角丸 | 16px (2xl) |
| ボタン角丸 | 12px (xl) |
| チップ角丸 | 9999px (full) |
| 入力フィールド角丸 | 12px (xl) |
| タップターゲット最小サイズ | 44px × 44px |
| ページ左右パディング | 16px |
| カード内パディング | 16px |

---

## 5. 画面詳細

### 5.1 SCR-LOGIN: ログイン / 新規登録

**概要**: メールアドレスとパスワードによるログイン・新規登録画面

**レイアウト**:
```
┌─────────────────────────┐
│     ぱっと記録           │
│   放課後等デイサービス     │
│     支援記録              │
│                          │
│  [ログイン | 新規登録] Tab │
│                          │
│  ── ログインモード ──     │
│  メールアドレス [      ]  │
│  パスワード     [      ]  │
│  [ログイン]              │
│                          │
│  ── 新規登録モード ──     │
│  施設名     [          ]  │
│  表示名     [          ]  │
│  メールアドレス [      ]  │
│  パスワード   [        ]  │
│  [登録する]              │
└─────────────────────────┘
```

**入力項目**:
| フィールド | 型 | 必須 | バリデーション |
|---|---|---|---|
| メールアドレス | email | ○ | メール形式 |
| パスワード | password | ○ | 6文字以上 |
| 施設名（新規登録時） | text | ○ | - |
| 表示名（新規登録時） | text | ○ | - |

**動作**:
- ログイン成功 → `/` へリダイレクト
- 新規登録成功 → 施設作成 + プロフィール作成 → `/` へリダイレクト
- エラー時 → 画面上部に赤字でエラーメッセージ表示

---

### 5.2 SCR-HOME: 本日の記録（ホーム）

**概要**: 当日の記録進捗ダッシュボード

**レイアウト**:
```
┌─────────────────────────┐
│ きょうの記録    3/5 完了  │
│ 2026年2月22日（日）       │
│ ████████░░░░░ 進捗バー   │
├─────────────────────────┤
│ 未記録 (2)               │
│ ┌─────────────────────┐ │
│ │ 🟢 田中太郎          │ │
│ │    ○○小 / 3年  未記録 │ │
│ └─────────────────────┘ │
│ ┌─────────────────────┐ │
│ │ 🔵 鈴木花子          │ │
│ │    △△小 / 1年  未記録 │ │
│ └─────────────────────┘ │
│                          │
│ 記録済み (3)             │
│ ┌─────────────────────┐ │
│ │ 🟡 佐藤一郎    ✓    │ │
│ │    😊 工作・運動      │ │
│ └─────────────────────┘ │
├─────────────────────────┤
│ きょう 児童 帳票 履歴 設定│
└─────────────────────────┘
```

**表示データ**:
- 日付: 当日の日本語表記
- 進捗: 記録済み数 / 全児童数
- 未記録児童: カード形式（アイコン色、名前、学校/学年、「未記録」バッジ）
- 記録済み児童: カード形式（opacity 70%、気分絵文字、活動内容プレビュー）

**インタラクション**:
- 児童カードタップ → `/record/[childId]` へ遷移
- 児童未登録時 → 「児童を登録する」リンク表示

---

### 5.3 SCR-RECORD: 日次記録入力

**概要**: 児童ごとの支援記録入力フォーム

**レイアウト**:
```
┌─────────────────────────┐
│ ← 🟢 田中太郎   [編集中] │
├─────────────────────────┤
│                          │
│ 来所時刻    退所時刻      │
│ [14:30]     [17:30]      │
│                          │
│ きょうの気分             │
│ [😊良好] [😐普通] [😢不調]│
│                          │
│ 活動内容                 │
│ [工作][運動][学習]...     │
│                          │
│ 記録フレーズ             │
│  ▼ カテゴリ名             │
│  [✓ フレーズテキスト...]  │
│  [  フレーズテキスト...]  │
│                          │
│ メモ（自由記入）         │
│ [自由記述テキストエリア]  │
│                          │
│ 本日の支援記録まとめ     │
│   [AIで下書き作成] ボタン │
│ [直接入力 or AI下書き]   │
│                          │
│ 送迎方法                 │
│ [送迎車][保護者][自力][他]│
│                          │
│ [保存して次へ]           │
└─────────────────────────┘
```

**入力項目**:
| フィールド | 型 | 必須 | 初期値 |
|---|---|---|---|
| 来所時刻 | time | - | 現在時刻（新規時） |
| 退所時刻 | time | - | 空 |
| 気分 | 選択（3択） | - | 未選択 |
| 活動内容 | 複数選択チップ | - | 未選択 |
| 記録フレーズ | 複数選択リスト | - | 未選択 |
| メモ（自由記入） | textarea | - | 空 |
| 支援記録まとめ | textarea | - | 空（AIで下書き生成可能） |
| 送迎方法 | 単一選択チップ | - | 未選択 |

**特殊動作**:
- 既存記録がある場合 → 全フィールドに既存データを復元、「編集中」バッジ表示
- フレーズ → 児童の支援領域タグに合致するものを黄色ハイライト表示、上位にソート
- 保存後 → 次の未記録児童へ `router.replace`、全員記録済みなら `/` へ遷移
- 「AIで下書き作成」ボタン → 現在の入力内容 + 児童基本情報（年齢、学校、学年）をClaude APIに送信 → 生成テキストを支援記録まとめ欄に挿入
- 支援記録まとめ欄は直接手入力も可能

---

### 5.4 SCR-CHILDREN: 児童一覧

**概要**: 施設に登録された有効な児童の一覧

**レイアウト**:
```
┌─────────────────────────┐
│ 児童一覧           [+追加]│
├─────────────────────────┤
│ ┌─────────────────────┐ │
│ │ 🟢 田中太郎     >    │ │
│ │    ○○小 / 3年        │ │
│ └─────────────────────┘ │
│ ┌─────────────────────┐ │
│ │ 🔵 鈴木花子     >    │ │
│ │    △△小 / 1年        │ │
│ └─────────────────────┘ │
├─────────────────────────┤
│ きょう 児童 帳票 履歴 設定│
└─────────────────────────┘
```

---

### 5.5 SCR-CHILD-NEW / SCR-CHILD-EDIT: 児童登録・編集

**入力項目**:
| フィールド | 型 | 必須 | 説明 |
|---|---|---|---|
| 名前 | text | ○ | 児童の氏名 |
| ふりがな | text | - | カタカナ/ひらがな |
| 生年月日 | date | - | - |
| 学校 | text | - | - |
| 学年 | text | - | - |
| アイコン色 | 色選択 | - | 8色プリセットから選択 |
| 支援領域タグ | 複数選択チップ | - | 5つの支援領域から選択 |
| 個別目標 | テキストリスト | - | 動的に追加・削除可能 |
| 有効/無効（編集時） | トグル | - | 論理削除用 |

**アイコン色プリセット**:
`#1B6B4A`, `#E8913A`, `#3B82F6`, `#8B5CF6`, `#EC4899`, `#EF4444`, `#14B8A6`, `#F59E0B`

---

### 5.6 SCR-DAILY-LOG: 業務日誌

**概要**: 指定日の全児童の支援記録を表形式で表示・印刷

**レイアウト**:
```
┌─────────────────────────────────────┐
│ 業務日誌                   [印刷]    │
│ 施設名: ○○放課後等デイサービス       │
│ 日付: [2026-02-22]                   │
├───┬────┬────┬────┬──────────┬───┬────┤
│名前│来所 │退所│活動│支援記録ﾏﾄﾒ│送迎│記録者│
├───┼────┼────┼────┼──────────┼───┼────┤
│太郎│14:30│17:30│工作│本日は...  │送迎│田中 │
│花子│14:00│17:00│運動│運動で...  │保護│鈴木 │
├───┴────┴────┴────┴──────────┴───┴────┤
│ 管理者署名:          確認者署名:      │
└─────────────────────────────────────┘
```

---

### 5.7 SCR-SVC-REC: サービス提供記録

**概要**: 個別児童のサービス内容を帳票形式で表示・印刷

**表示内容**:
- 児童基本情報（名前、生年月日、学校、学年、支援領域、個別目標）
- 支援記録詳細（時刻、気分、活動、フレーズ、メモ、支援記録まとめ、送迎方法）
- 保護者確認欄、管理者署名欄

---

### 5.8 SCR-MONTHLY: 月間出席サマリー

**概要**: 月単位の出席状況をカレンダーグリッドで表示

**レイアウト**:
```
┌──────────────────────────────────────┐
│ 月間出席サマリー              [印刷]  │
│ [◀ 2026年2月 ▶]                     │
├────┬─┬─┬─┬─┬─┬─┬─┬─┬──┬───────────┤
│名前│1│2│3│4│5│...│28│合計│            │
├────┼─┼─┼─┼─┼─┼─┼──┼──┼───────────┤
│太郎│◯│ │◯│◯│ │   │◯ │15 │            │
│花子│◯│◯│ │◯│◯│   │  │18 │            │
├────┴─┴─┴─┴─┴─┴─┴──┴──┴───────────┤
│ 合計│5│3│4│...                       │
└──────────────────────────────────────┘
```

---

### 5.9 SCR-SETTINGS: 設定メニュー

**メニュー項目**:
| 項目 | 遷移先 | 表示条件 |
|---|---|---|
| プロフィール | `/settings/profile` | 全ユーザー |
| フレーズ管理 | `/settings/phrases` | 全ユーザー |
| 施設設定 | `/settings/facility` | admin のみ |
| スタッフ管理 | `/settings/staff` | admin のみ |
| ログアウト | アクション（遷移なし） | 全ユーザー |

---

## 6. UIコンポーネント仕様

### 6.1 Button
| Props | 型 | 説明 |
|---|---|---|
| variant | `"primary" \| "secondary" \| "danger" \| "ghost"` | スタイルバリアント |
| fullWidth | `boolean` | 横幅100% |
| disabled | `boolean` | 無効状態 |
| children | `ReactNode` | ボタンテキスト |

### 6.2 Card
| Props | 型 | 説明 |
|---|---|---|
| padding | `boolean` (default: true) | 内部パディングの有無 |
| className | `string` | 追加CSSクラス |

### 6.3 Chip
| Props | 型 | 説明 |
|---|---|---|
| label | `string` | 表示テキスト |
| selected | `boolean` | 選択状態 |
| onToggle | `() => void` | トグルハンドラ |
| size | `"sm" \| "md"` | サイズ |

### 6.4 Input / Textarea
| Props | 型 | 説明 |
|---|---|---|
| label | `string` | ラベルテキスト |
| error | `string` | エラーメッセージ |
| (HTML attributes) | - | 標準input/textarea属性 |

### 6.5 Header
| Props | 型 | 説明 |
|---|---|---|
| title | `string` | タイトルテキスト |
| showBack | `boolean` | 戻るボタン表示 |
| right | `ReactNode` | 右側カスタムコンテンツ |

### 6.6 BottomNav
- 固定配置（画面下部）
- 5項目のナビゲーション
- アクティブ状態: primary カラーでハイライト
- セーフエリアパディング対応

---

## 7. 印刷対応

### 7.1 印刷時のスタイル制御
- `.no-print` クラス: 印刷時に非表示（ナビゲーション、ボタン等）
- `.print-only` クラス: 印刷時のみ表示（署名欄等）
- ページサイズ: A4（業務日誌・サービス提供記録は縦、月間サマリーは横）
- 余白: 上下左右10mm
